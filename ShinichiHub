-- Config
_G.ESPChest = true -- Bật/tắt ESP Chest
_G.StopGodChalice = true -- Dừng khi nhặt được God Chalice hoặc Fist of Darkness
_G.JoinTeam = "Pirates" -- Chọn team: "Marines" hoặc "Pirates"

-- Thông báo khi script load thành công
game.StarterGui:SetCore("SendNotification", {
    Title = "Shinichi Hub";
    Text = "Load Success!";
    Duration = 5;
})

-- Tự động join team
spawn(function()
    local team = _G.JoinTeam
    local plyr = game.Players.LocalPlayer
    if team == "Marines" or team == "Pirates" then
        for _, v in pairs(game:GetService("Teams"):GetChildren()) do
            if v.Name == team then
                plyr.Team = v
                break
            end
        end
    end
end)

-- UI Menu
local Library = loadstring(game:HttpGet("https://pastebin.com/raw/6mjaPjMp"))() -- Load UI Library
local Window = Library:CreateWindow("Shinichi Hub")

local MainTab = Window:CreateTab("Main")
local InfoTab = Window:CreateTab("Info")

local ChestCollect = 0
local PlayerMoney = game.Players.LocalPlayer.leaderstats.Beli.Value

MainTab:CreateToggle("ESP Chest", _G.ESPChest, function(value)
    _G.ESPChest = value
end)

MainTab:CreateToggle("Stop on God Chalice/Fist", _G.StopGodChalice, function(value)
    _G.StopGodChalice = value
end)

MainTab:CreateLabel("Your Money: $" .. PlayerMoney)
MainTab:CreateLabel("Chest Collect: " .. ChestCollect)

InfoTab:CreateLabel("Use Discord for Support")
InfoTab:CreateLabel("Discord Link: discord.gg/sAqcaJ4TsQ")

-- ESP Chest Function
spawn(function()
    while wait(1) do
        if _G.ESPChest then
            for _, v in pairs(workspace:GetChildren()) do
                if v:IsA("Model") and string.find(v.Name, "Chest") then
                    if not v:FindFirstChild("ESP") then
                        local esp = Instance.new("BillboardGui", v)
                        esp.Name = "ESP"
                        esp.Size = UDim2.new(1, 200, 1, 30)
                        esp.Adornee = v
                        esp.AlwaysOnTop = true
                        local text = Instance.new("TextLabel", esp)
                        text.Size = UDim2.new(1, 0, 1, 0)
                        text.BackgroundTransparency = 1
                        text.Font = Enum.Font.GothamSemibold
                        text.TextSize = 14
                        text.TextColor3 = Color3.fromRGB(255, 255, 255)
                        spawn(function()
                            while _G.ESPChest and v:FindFirstChild("ESP") do
                                text.Text = v.Name .. " | " .. math.floor((game.Players.LocalPlayer.Character.HumanoidRootPart.Position - v.Position).Magnitude) .. "m"
                                wait(0.5)
                            end
                        end)
                    end
                end
            end
        else
            for _, v in pairs(workspace:GetChildren()) do
                if v:FindFirstChild("ESP") then
                    v:FindFirstChild("ESP"):Destroy()
                end
            end
        end
    end
end)

-- Auto Collect Chest
spawn(function()
    while wait(1) do
        for _, v in pairs(workspace:GetChildren()) do
            if v:IsA("Model") and string.find(v.Name, "Chest") then
                local distance = (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - v.Position).Magnitude
                if distance < 50 then
                    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = v:GetModelCFrame()
                    wait(0.5)
                    ChestCollect = ChestCollect + 1
                    MainTab:UpdateLabel("Chest Collect: " .. ChestCollect)
                end
            end
        end
    end
end)

-- Stop if God Chalice or Fist of Darkness is Found
spawn(function()
    while wait(1) do
        if _G.StopGodChalice then
            for _, v in pairs(workspace:GetChildren()) do
                if v:IsA("Tool") and (v.Name == "God Chalice" or v.Name == "Fist of Darkness") then
                    game.StarterGui:SetCore("SendNotification", {
                        Title = "Shinichi Hub";
                        Text = "God Chalice/Fist of Darkness Found! Stopping...";
                        Duration = 5;
                    })
                    return
                end
            end
        end
    end
end)

-- Hop Server when No More Chests
spawn(function()
    while wait(10) do
        local chestFound = false
        for _, v in pairs(workspace:GetChildren()) do
            if v:IsA("Model") and string.find(v.Name, "Chest") then
                chestFound = true
                break
            end
        end
        if not chestFound then
            game.StarterGui:SetCore("SendNotification", {
                Title = "Shinichi Hub";
                Text = "Hopping Server in 3s...";
                Duration = 3;
            })
            wait(3)
            local TeleportService = game:GetService("TeleportService")
            TeleportService:Teleport(game.PlaceId, game.Players.LocalPlayer)
        end
    end
end)
